Ported from the PHP source of QM Promisance v4.81, available at http://sourceforge.net/projects/qmpromisance.

Original source is licensed the GPLv2.
